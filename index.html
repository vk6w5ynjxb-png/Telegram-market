<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Tahoma, sans-serif; background: var(--tg-theme-bg-color, #f5f5f5); color: var(--tg-theme-text-color, #000); padding: 15px; margin: 0; }
        .card { background: var(--tg-theme-secondary-bg-color, #fff); padding: 15px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        h3 { margin-top: 0; color: var(--tg-theme-button-color, #3390ec); }
        
        label { display: block; margin: 10px 0 5px; font-size: 13px; color: var(--tg-theme-hint-color, #888); }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; background: var(--tg-theme-bg-color, #fff); color: var(--tg-theme-text-color, #000); box-sizing: border-box; outline: none; transition: 0.3s; }
        input:focus, select:focus, textarea:focus { border-color: var(--tg-theme-button-color, #3390ec); }
        
        /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ */
        .cat-selector { display: flex; gap: 10px; margin-bottom: 20px; }
        .cat-btn { flex: 1; padding: 15px; border: 2px solid #ddd; border-radius: 10px; text-align: center; cursor: pointer; font-weight: bold; background: var(--tg-theme-bg-color, #fff); }
        .cat-btn.active { border-color: var(--tg-theme-button-color, #3390ec); background-color: rgba(51, 144, 236, 0.1); color: var(--tg-theme-button-color, #3390ec); }
        
        /* Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø¨Ø®Ø´â€ŒÙ‡Ø§ */
        .hidden { display: none; }
        
        button.submit-btn { width: 100%; padding: 15px; background-color: var(--tg-theme-button-color, #3390ec); color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: bold; margin-top: 20px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="card">
        <h3>ğŸ“‚ Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</h3>
        <div class="cat-selector">
            <div class="cat-btn active" onclick="selectCat('estate')" id="btn-estate">ğŸ  Ø§Ù…Ù„Ø§Ú©</div>
            <div class="cat-btn" onclick="selectCat('goods')" id="btn-goods">ğŸ› Ø§Ø¬Ù†Ø§Ø³</div>
        </div>
    </div>

    <div id="form-estate" class="card">
        <h3>ğŸ  Ù…Ø´Ø®ØµØ§Øª Ù…Ù„Ú©</h3>
        <label>Ù†ÙˆØ¹ Ù…Ù„Ú©:</label>
        <select id="est-type">
            <option value="Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù†">Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù†</option>
            <option value="Ø®Ø§Ù†Ù‡ ÙˆÛŒÙ„Ø§ÛŒÛŒ">Ø®Ø§Ù†Ù‡ ÙˆÛŒÙ„Ø§ÛŒÛŒ (Ù…Ø³ØªÙ‚Ù„)</option>
            <option value="Ø²Ù…ÛŒÙ†/Ú©Ù„Ù†Ú¯ÛŒ">Ø²Ù…ÛŒÙ† Ø®Ø§Ù„ÛŒ / Ú©Ù„Ù†Ú¯ÛŒ</option>
            <option value="ØªØ¬Ø§Ø±ÛŒ/Ù…ØºØ§Ø²Ù‡">ØªØ¬Ø§Ø±ÛŒ / Ù…ØºØ§Ø²Ù‡</option>
        </select>

        <div style="display: flex; gap: 10px;">
            <div style="flex: 1;">
                <label>Ù…ØªØ±Ø§Ú˜ (Ù…ØªØ±):</label>
                <input type="number" id="est-area" placeholder="Ù…Ø«Ù„Ø§ 120">
            </div>
            <div style="flex: 1;">
                <label>Ø³Ù† Ø¨Ù†Ø§ (Ø³Ø§Ù„):</label>
                <input type="number" id="est-age" placeholder="Ù…Ø«Ù„Ø§ 5">
            </div>
        </div>
        
        <label>ØªØ¹Ø¯Ø§Ø¯ Ø§ØªØ§Ù‚:</label>
        <select id="est-rooms">
            <option value="0">Ø¨Ø¯ÙˆÙ† Ø§ØªØ§Ù‚</option>
            <option value="1">ÛŒÚ© Ø®ÙˆØ§Ø¨Ù‡</option>
            <option value="2">Ø¯Ùˆ Ø®ÙˆØ§Ø¨Ù‡</option>
            <option value="3">Ø³Ù‡ Ø®ÙˆØ§Ø¨Ù‡ Ùˆ Ø¨ÛŒØ´ØªØ±</option>
        </select>
    </div>

    <div id="form-goods" class="card hidden">
        <h3>ğŸ› Ù…Ø´Ø®ØµØ§Øª Ú©Ø§Ù„Ø§</h3>
        <label>Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ú©Ø§Ù„Ø§:</label>
        <select id="g-type">
            <option value="Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ">ğŸ“± Ù„ÙˆØ§Ø²Ù… Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ (Ù…ÙˆØ¨Ø§ÛŒÙ„/Ù„Ù¾â€ŒØªØ§Ù¾)</option>
            <option value="Ø®Ø§Ù†Ú¯ÛŒ">ğŸ›‹ Ù„ÙˆØ§Ø²Ù… Ø®Ø§Ù†Ú¯ÛŒ</option>
            <option value="Ù¾ÙˆØ´Ø§Ú©">ğŸ‘• Ù¾ÙˆØ´Ø§Ú© Ùˆ Ù…Ø¯</option>
            <option value="Ø®ÙˆØ¯Ø±Ùˆ">ğŸš— ÙˆØ³Ø§ÛŒÙ„ Ù†Ù‚Ù„ÛŒÙ‡</option>
            <option value="Ø³Ø§ÛŒØ±">ğŸ“¦ Ø³Ø§ÛŒØ±</option>
        </select>

        <label>ÙˆØ¶Ø¹ÛŒØª Ú©Ø§Ù„Ø§:</label>
        <select id="g-status">
            <option value="Ù†Ùˆ (Ø¢Ú©Ø¨Ù†Ø¯)">Ù†Ùˆ (Ø¢Ú©Ø¨Ù†Ø¯)</option>
            <option value="Ø¯Ø± Ø­Ø¯ Ù†Ùˆ">Ø¯Ø³Øª Ø¯ÙˆÙ… (Ø¯Ø± Ø­Ø¯ Ù†Ùˆ)</option>
            <option value="Ú©Ø§Ø±Ú©Ø±Ø¯Ù‡">Ø¯Ø³Øª Ø¯ÙˆÙ… (Ú©Ø§Ø±Ú©Ø±Ø¯Ù‡)</option>
            <option value="Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØ¹Ù…ÛŒØ±">Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØ¹Ù…ÛŒØ±</option>
        </select>
    </div>

    <div class="card">
        <h3>ğŸ“ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÚ©Ù…ÛŒÙ„ÛŒ</h3>
        <label>Ø¹Ù†ÙˆØ§Ù† Ø¢Ú¯Ù‡ÛŒ:</label>
        <input type="text" id="common-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ú©ÙˆØªØ§Ù‡ Ùˆ Ø¬Ø°Ø§Ø¨">

        <label>Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†):</label>
        <input type="number" id="common-price" placeholder="Ù…Ø«Ù„Ø§ 5000000">

        <label>ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ø§Ù…Ù„:</label>
        <textarea id="common-desc" rows="4" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ù…ÙˆØ±Ø¯ Ø¢Ú¯Ù‡ÛŒ..."></textarea>
    </div>

    <button class="submit-btn" onclick="submitData()">Ø«Ø¨Øª Ùˆ Ø§Ø±Ø³Ø§Ù„ Ø¨Ø±Ø§ÛŒ ØªØ§ÛŒÛŒØ¯</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        let currentCat = 'estate';

        function selectCat(cat) {
            currentCat = cat;
            // ØªØºÛŒÛŒØ± Ø§Ø³ØªØ§ÛŒÙ„ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
            document.getElementById('btn-estate').classList.toggle('active', cat === 'estate');
            document.getElementById('btn-goods').classList.toggle('active', cat === 'goods');
            
            // Ù†Ù…Ø§ÛŒØ´/Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ÙØ±Ù…â€ŒÙ‡Ø§
            document.getElementById('form-estate').classList.toggle('hidden', cat !== 'estate');
            document.getElementById('form-goods').classList.toggle('hidden', cat !== 'goods');
        }

        function submitData() {
            const title = document.getElementById('common-title').value;
            const price = document.getElementById('common-price').value;
            const desc = document.getElementById('common-desc').value;

            if(!title || !price) {
                tg.showPopup({title: 'Ø®Ø·Ø§', message: 'Ù„Ø·ÙØ§ Ø¹Ù†ÙˆØ§Ù† Ùˆ Ù‚ÛŒÙ…Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯'});
                return;
            }

            let finalData = {
                action: "new_post",
                category: currentCat, // estate ÛŒØ§ goods
                title: title,
                price: price,
                description: desc,
                details: {} // Ø¬Ø²Ø¦ÛŒØ§Øª Ù…ØªØºÛŒØ±
            };

            // Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¯Ø³ØªÙ‡ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ
            if (currentCat === 'estate') {
                finalData.details = {
                    type: document.getElementById('est-type').value,
                    area: document.getElementById('est-area').value,
                    age: document.getElementById('est-age').value,
                    rooms: document.getElementById('est-rooms').value
                };
            } else {
                finalData.details = {
                    type: document.getElementById('g-type').value,
                    status: document.getElementById('g-status').value
                };
            }

            // Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ø±Ø¨Ø§Øª
            tg.sendData(JSON.stringify(finalData));
        }
    </script>
</body>
</html>
