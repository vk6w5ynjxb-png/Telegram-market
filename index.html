<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¨Ø§Ø²Ø§Ø±Ú†Ù‡ Ú©Ø§Ù…Ù„</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --main-color: #3390ec; --bg: var(--tg-theme-bg-color, #fff); --text: var(--tg-theme-text-color, #000); --sec-bg: var(--tg-theme-secondary-bg-color, #f4f4f5); }
        body { font-family: Tahoma, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 70px; }
        
        /* ØªØ¨â€ŒÙ‡Ø§ */
        .tab-content { display: none; padding: 15px; }
        .tab-content.active { display: block; }

        /* Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ */
        .card { background: var(--sec-bg); border-radius: 12px; padding: 15px; margin-bottom: 15px; }
        h3 { margin-top: 0; color: var(--main-color); font-size: 16px; }

        /* ÙØ±Ù…â€ŒÙ‡Ø§ */
        label { display: block; margin: 10px 0 5px; font-size: 12px; color: var(--tg-theme-hint-color, #888); }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; background: var(--bg); color: var(--text); box-sizing: border-box; outline: none; }
        
        /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ */
        .cat-row { display: flex; gap: 10px; margin-bottom: 15px; }
        .cat-btn { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 8px; text-align: center; cursor: pointer; background: var(--bg); }
        .cat-btn.active { border-color: var(--main-color); background: rgba(51, 144, 236, 0.1); color: var(--main-color); font-weight: bold; }

        .hidden { display: none; }
        .submit-btn { width: 100%; padding: 14px; background: var(--main-color); color: white; border: none; border-radius: 10px; font-size: 16px; margin-top: 15px; }

        /* Ù†ÙˆØ§Ø± Ù¾Ø§ÛŒÛŒÙ† */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: var(--bg); border-top: 1px solid #ddd; display: flex; justify-content: space-around; padding: 10px 0; z-index: 100; }
        .nav-item { text-align: center; font-size: 10px; color: #aaa; cursor: pointer; }
        .nav-item.active { color: var(--main-color); }
        .nav-item i { font-size: 20px; margin-bottom: 4px; }
    </style>
</head>
<body>

    <div id="tab-home" class="tab-content active">
        <div class="card" style="text-align: center; padding: 30px;">
            <i class="fa fa-shopping-bag" style="font-size: 40px; color: #ddd;"></i>
            <p>Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ†ØŒ Ù„Ø·ÙØ§ Ø§Ø² Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø±Ø¨Ø§Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</p>
            <small style="color: #888;">(Ù†Ø³Ø®Ù‡ ÙˆØ¨â€ŒØ§Ù¾ Ø¢ÙÙ„Ø§ÛŒÙ† Ø§Ø³Øª)</small>
        </div>
    </div>

    <div id="tab-add" class="tab-content">
        <div class="card">
            <h3>ğŸ“ Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ</h3>
            <label>Ø§Ø³ØªØ§Ù† / Ø´Ù‡Ø±:</label>
            <input type="text" id="city" placeholder="Ù…Ø«Ù„Ø§: ØªÙ‡Ø±Ø§Ù†ØŒ Ø³Ø¹Ø§Ø¯Øª Ø¢Ø¨Ø§Ø¯">
        </div>

        <div class="card">
            <h3>ğŸ“‚ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</h3>
            <div class="cat-row">
                <div class="cat-btn active" onclick="selectCat('estate')" id="btn-estate">ğŸ  Ø§Ù…Ù„Ø§Ú©</div>
                <div class="cat-btn" onclick="selectCat('goods')" id="btn-goods">ğŸ› Ø§Ø¬Ù†Ø§Ø³</div>
            </div>

            <div id="form-estate">
                <label>Ù†ÙˆØ¹ Ù…Ù„Ú©:</label>
                <select id="est-type">
                    <option>Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù†</option><option>ÙˆÛŒÙ„Ø§ÛŒÛŒ</option><option>Ø²Ù…ÛŒÙ†</option><option>ØªØ¬Ø§Ø±ÛŒ</option>
                </select>
                <div style="display:flex; gap:10px;">
                    <div style="flex:1"><label>Ù…ØªØ±Ø§Ú˜ (Ù…ØªØ±):</label><input type="number" id="est-area"></div>
                    <div style="flex:1"><label>Ø³Ù† Ø¨Ù†Ø§ (Ø³Ø§Ù„):</label><input type="number" id="est-age"></div>
                </div>
            </div>

            <div id="form-goods" class="hidden">
                <label>Ù†ÙˆØ¹ Ú©Ø§Ù„Ø§:</label>
                <select id="g-type">
                    <option>Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ</option><option>Ø®ÙˆØ¯Ø±Ùˆ</option><option>Ø®Ø§Ù†Ú¯ÛŒ</option><option>Ù¾ÙˆØ´Ø§Ú©</option>
                </select>
                <label>ÙˆØ¶Ø¹ÛŒØª:</label>
                <select id="g-status">
                    <option>Ù†Ùˆ (Ø¢Ú©Ø¨Ù†Ø¯)</option><option>Ø¯Ø± Ø­Ø¯ Ù†Ùˆ</option><option>Ú©Ø§Ø±Ú©Ø±Ø¯Ù‡</option>
                </select>
            </div>
        </div>

        <div class="card">
            <h3>ğŸ“ Ù…Ø´Ø®ØµØ§Øª Ú©Ù„ÛŒ</h3>
            <label>Ø¹Ù†ÙˆØ§Ù†:</label><input type="text" id="title">
            <label>Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†):</label><input type="tel" id="price">
            <label>ØªÙˆØ¶ÛŒØ­Ø§Øª:</label><textarea id="desc" rows="3"></textarea>
            
            <div style="margin-top: 15px; padding: 10px; background: #eeffff; border-radius: 8px; font-size: 12px; color: #007777;">
                ğŸ“¸ <b>ØªÙˆØ¬Ù‡:</b> ØªØµÙˆÛŒØ± Ø¢Ú¯Ù‡ÛŒ Ø±Ø§ Ø¯Ø± Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯ (Ø¯Ø§Ø®Ù„ Ø±Ø¨Ø§Øª) Ø§Ø±Ø³Ø§Ù„ Ø®ÙˆØ§Ù‡ÛŒØ¯ Ú©Ø±Ø¯.
            </div>
        </div>

        <button class="submit-btn" onclick="submitData()">ØªØ§ÛŒÛŒØ¯ Ùˆ Ø±ÙØªÙ† Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ Ø§Ø±Ø³Ø§Ù„ Ø¹Ú©Ø³</button>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('home', this)">
            <i class="fa fa-home"></i><br>Ø®Ø§Ù†Ù‡
        </div>
        <div class="nav-item" onclick="switchTab('add', this)">
            <i class="fa fa-plus-circle"></i><br>Ø«Ø¨Øª Ø¢Ú¯Ù‡ÛŒ
        </div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        let currentCat = 'estate';

        function switchTab(tabName, el) {
            document.querySelectorAll('.tab-content').forEach(d => d.classList.remove('active'));
            document.getElementById('tab-' + tabName).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
        }

        function selectCat(cat) {
            currentCat = cat;
            document.getElementById('btn-estate').classList.toggle('active', cat === 'estate');
            document.getElementById('btn-goods').classList.toggle('active', cat === 'goods');
            document.getElementById('form-estate').classList.toggle('hidden', cat !== 'estate');
            document.getElementById('form-goods').classList.toggle('hidden', cat !== 'goods');
        }

        function submitData() {
            const city = document.getElementById('city').value;
            const title = document.getElementById('title').value;
            const price = document.getElementById('price').value;
            const desc = document.getElementById('desc').value;

            if(!title || !price || !city) {
                tg.showPopup({title: 'Ø®Ø·Ø§', message: 'Ù„Ø·ÙØ§ Ø´Ù‡Ø±ØŒ Ø¹Ù†ÙˆØ§Ù† Ùˆ Ù‚ÛŒÙ…Øª Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯'});
                return;
            }

            let data = {
                action: "new_post",
                category: currentCat,
                city: city,
                title: title,
                price: price,
                description: desc,
                details: {}
            };

            if(currentCat === 'estate') {
                data.details = {
                    type: document.getElementById('est-type').value,
                    area: document.getElementById('est-area').value,
                    age: document.getElementById('est-age').value
                };
            } else {
                data.details = {
                    type: document.getElementById('g-type').value,
                    status: document.getElementById('g-status').value
                };
            }

            tg.sendData(JSON.stringify(data));
        }
    </script>
</body>
</html>
